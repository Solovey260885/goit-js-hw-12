{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nexport const pagination = {\n  page: 1,\n  perPage: 15,\n};\nconst spinner = document.querySelector('.loader');\n\nfunction showSpinner() {\n  spinner.style.display = 'flex';\n}\n\nexport function hideSpinner() {\n  spinner.style.display = 'none';\n}\n\nexport async function getPicturesByQuery(query) {\n  const params = new URLSearchParams({\n    key: '44773491-691b01ebde89d181347bf66a7',\n    q: query,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    per_page: pagination.perPage,\n    page: pagination.page,\n  });\n\n  showSpinner();\n\n  return await axios\n    .get(`https://pixabay.com/api/?${params}`)\n    .then(response => response.data);\n}\n\nexport function onFetchError(error) {\n  iziToast.error({\n    title: 'Error',\n    message:\n      '2Sorry, there are no images matching your search query. Please try again!',\n    position: 'topRight',\n  });\n}\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nexport const cardContainer = document.querySelector('.card-container');\n\nexport async function renderImgCard(dataArr) {\n  const markupImages = dataArr\n    .map(\n      ({\n        webformatURL,\n        largeImageURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<li class=\"gallery-item\">\n            <a class=\"gallery-link\" href=\"${largeImageURL}\">\n                <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" width=\"360\" height=\"200\"/>\n                <ul class=\"gallery-text-list\">\n                    <li class=\"gallery-text-item\"><h3>Likes</h3><p>${likes}</p></li>\n                    <li class=\"gallery-text-item\"><h3>Views</h3><p>${views}</p></li>\n                    <li class=\"gallery-text-item\"><h3>Comments</h3><p>${comments}</p></li>\n                    <li class=\"gallery-text-item\"><h3>Downloads</h3><p>${downloads}</p></li>\n                </ul>\n            </a>\n        </li>`\n    )\n    .join('');\n  cardContainer.insertAdjacentHTML('beforeend', markupImages);\n\n  const lightbox = new SimpleLightbox('.card-container a', {\n    captionsData: 'alt',\n    captionPosition: 'bottom',\n    captionDelay: 250,\n  });\n\n  lightbox.refresh();\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport {\n  getPicturesByQuery,\n  onFetchError,\n  hideSpinner,\n  pagination,\n} from './js/pixabay-api';\n\nimport { renderImgCard, cardContainer } from './js/render-functions';\n\nconst searchForm = document.querySelector('.search-form');\nconst btnLoadMore = document.querySelector('.btn-load-more');\nconst spinner = document.querySelector('.loader');\nconst hiddenClass = 'is-hidden';\n\nlet queryValue = '';\nlet totalPages = 0;\n\nsearchForm.addEventListener('submit', handleSearch);\n\nexport function showSpinner() {\n  spinner.style.display = 'flex';\n}\n\nfunction hide(button) {\n  button.classList.add(hiddenClass);\n}\n\nfunction show(button) {\n  button.classList.remove(hiddenClass);\n}\n\nfunction disable(button) {\n  button.disabled = true;\n}\n\nfunction enable(button) {\n  button.disabled = false;\n}\n\nhide(btnLoadMore);\n\nasync function handleSearch(event) {\n  event.preventDefault();\n  cardContainer.innerHTML = '';\n  const form = event.currentTarget;\n  queryValue = form.elements.query.value.trim();\n\n  if (queryValue === '') {\n    disable(btnLoadMore);\n    iziToast.warning({\n      title: 'Caution',\n      message: 'Please, enter in the photo',\n      position: 'topRight',\n    });\n    form.reset();\n    return;\n  }\n\n  try {\n    let data = await getPicturesByQuery(queryValue);\n    renderImgCard(data.hits);\n    show(btnLoadMore);\n    totalPages = Math.ceil(data.total / pagination.perPage);\n\n    if (pagination.page > totalPages) {\n      hide(btnLoadMore);\n      return iziToast.error({\n        position: 'topRight',\n        message: \"We're sorry, there are no more posts to load\",\n      });\n    }\n    enable(btnLoadMore);\n\n    btnLoadMore.addEventListener('click', handleLoadMore);\n  } catch (error) {\n    onFetchError();\n  } finally {\n    hideSpinner();\n    form.reset();\n  }\n}\n\nasync function handleLoadMore() {\n  disable(btnLoadMore);\n  pagination.page += 1;\n\n  try {\n    let data = await getPicturesByQuery(queryValue);\n    renderImgCard(data.hits);\n\n    const galleryItem = document.querySelector('.gallery-item');\n    const itemHeight = galleryItem.getBoundingClientRect().height;\n    window.scrollBy({\n      top: itemHeight * 2,\n      behavior: 'smooth',\n    });\n  } catch (error) {\n    console.error(error);\n    onFetchError();\n  } finally {\n    enable(btnLoadMore);\n\n    if (pagination.page >= totalPages) {\n      hide(btnLoadMore);\n\n      btnLoadMore.removeEventListener('click', handleLoadMore);\n      iziToast.warning({\n        title: 'Caution',\n        message: \"We're sorry, but you've reached the end of search results.\",\n        position: 'topRight',\n      });\n    }\n    hideSpinner();\n  }\n}\n"],"names":["pagination","spinner","showSpinner","hideSpinner","getPicturesByQuery","query","params","axios","response","onFetchError","error","iziToast","cardContainer","renderImgCard","dataArr","markupImages","webformatURL","largeImageURL","tags","likes","views","comments","downloads","SimpleLightbox","searchForm","btnLoadMore","hiddenClass","queryValue","totalPages","handleSearch","hide","button","show","disable","enable","event","form","data","handleLoadMore","itemHeight"],"mappings":"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"}